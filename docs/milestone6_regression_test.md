# 回归测试清单

## 测试环境准备

### 测试账号

| 角色 | 用户名 | 密码 |
|------|--------|------|
| 管理员 | admin | 123456 |
| 执行者 | executor1 | 123456 |

### 启动服务

```bash
# 1. 后端
cd backend && mvn spring-boot:run

# 2. 管理后台
cd admin-web && npm run dev

# 3. 微信小程序
微信开发者工具打开 miniapp 目录
```

---

## M3 工单闭环测试

### TC-3.1 维修工单完整流程

- [ ] 微信端登录 executor1
- [ ] 首页点击"故障上报"
- [ ] 选择设施、填写故障描述、提交
- [ ] 后台 admin 登录，工单管理看到新工单（待派发）
- [ ] 派单给 executor1
- [ ] 微信端任务中心看到工单（已派发）
- [ ] 点击接单，状态变为"已接单"
- [ ] 点击填写处理记录，上传图片，提交
- [ ] 后台工单详情看到处理信息
- [ ] 点击验收通过，状态变为"已完成"
- [ ] 点击归档，状态变为"已归档"

### TC-3.2 工单转派

- [ ] 后台对已派发/已接单工单点击"转派"
- [ ] 选择新执行人
- [ ] 工单分配给新执行人

---

## M4 保养闭环测试

### TC-4.1 保养计划创建

- [ ] 后台 → 保养计划 → 新增计划
- [ ] 选择设施、填写保养内容、设置周期（每天）
- [ ] 创建成功，列表显示新计划

### TC-4.2 保养工单自动生成

- [ ] 确认计划的下次执行时间已到
- [ ] 重启后端触发定时任务
- [ ] 工单管理中出现保养工单（orderType=2）
- [ ] 保养工单流程与维修工单一致

### TC-4.3 保养计划启停

- [ ] 停用保养计划
- [ ] 确认不再生成新工单
- [ ] 重新启用保养计划
- [ ] 确认恢复生成

---

## M5 库存闭环测试

### TC-5.1 备件管理

- [ ] 后台 → 库存管理 → 备件台账
- [ ] 新增备件（编码、名称、单位、预警阈值）
- [ ] 编辑备件信息
- [ ] 停用/启用备件

### TC-5.2 入库操作

- [ ] 点击备件行"入库"按钮
- [ ] 输入数量、备注
- [ ] 确认库存增加
- [ ] 库存流水标签页显示入库记录

### TC-5.3 出库操作

- [ ] 点击备件行"出库"按钮
- [ ] 输入数量（不超过当前库存）
- [ ] 确认库存减少
- [ ] 尝试出库超过库存的数量 → 应报错

### TC-5.4 库存预警

- [ ] 将某备件库存降至预警阈值以下
- [ ] 库存预警标签页显示该备件

### TC-5.5 工单消耗关联

- [ ] 微信端处理工单时选择消耗备件
- [ ] 提交后确认库存扣减
- [ ] 后台工单详情显示消耗记录
- [ ] 微信端工单详情显示消耗记录

### TC-5.6 删除消耗记录

- [ ] 后台工单详情点击消耗记录的"删除"
- [ ] 确认库存回退
- [ ] 已归档工单的消耗记录不可删除

---

## M6 统计分析测试

### TC-6.1 统计看板

- [ ] 后台 → 统计分析
- [ ] 工单总数、完成数、完成率显示正确
- [ ] 待处理数、待验收数显示正确
- [ ] 平均处理耗时显示正确

### TC-6.2 时间范围筛选

- [ ] 选择时间范围
- [ ] 点击查询
- [ ] 统计数据根据时间范围更新

### TC-6.3 故障高发设施

- [ ] Top 5 列表显示维修次数最多的设施
- [ ] 排名、设施编码、名称、次数显示正确

### TC-6.4 微信端个人统计

- [ ] 微信端 → 我的
- [ ] 显示总工单、已完成、待处理数量
- [ ] 显示平均处理耗时

---

## 权限与安全测试

### TC-P.1 未登录访问

- [ ] 后台未登录访问任意页面 → 跳转登录
- [ ] 微信端未登录访问任务中心 → 跳转登录

### TC-P.2 Token过期

- [ ] 清除 localStorage 中的 token
- [ ] 刷新页面 → 跳转登录

---

## 数据一致性测试

### TC-D.1 系统重启

- [ ] 重启后端服务
- [ ] 确认所有数据正常加载
- [ ] 工单状态、库存数量无变化

### TC-D.2 并发操作

- [ ] 两个窗口同时操作同一工单
- [ ] 确认状态一致，无脏数据

---

## 测试结果汇总

| 模块 | 通过 | 失败 | 备注 |
|------|------|------|------|
| M3 工单闭环 | | | |
| M4 保养闭环 | | | |
| M5 库存闭环 | | | |
| M6 统计分析 | | | |
| 权限安全 | | | |
| 数据一致性 | | | |

---

## 测试人员签字

- 测试人员：_______________
- 测试日期：_______________
- 测试结论：[ ] 通过  [ ] 有问题待修复
